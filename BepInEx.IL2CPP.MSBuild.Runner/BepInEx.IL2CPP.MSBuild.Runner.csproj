<Project Sdk="Microsoft.NET.Sdk">
    <PropertyGroup>
        <Description>The payload assembly executed after dynamically loading Il2CppInterop</Description>
    </PropertyGroup>

    <ItemGroup>
        <PackageReference Include="Microsoft.Build.Utilities.Core" Version="16.11.6" />
        <PackageReference Include="Il2CppInterop.Generator" Version="1.5.0" />
        <ProjectReference Include="..\BepInEx.IL2CPP.MSBuild.Shared\BepInEx.IL2CPP.MSBuild.Shared.csproj" />
    </ItemGroup>

    <ItemGroup Condition="$(TargetFramework) == 'net472'">
        <Reference Include="System.Net.Http" />
        <Reference Include="System.IO.Compression" />
    </ItemGroup>

    <Target Name="Copy" AfterTargets="Build">
      <PropertyGroup>
        <DllTargetFolder>$(SolutionDir)\BepInEx.IL2CPP.MSBuild\bin\$(Configuration)\$(TargetFramework)</DllTargetFolder>
      </PropertyGroup>
      <MakeDir Directories="$(DllTargetFolder)" Condition="!Exists('$(DllTargetFolder)')" />
      <ItemGroup>
        <DllFiles Include="$(OutputPath)\*.dll" />
      </ItemGroup>
      <Copy
        SourceFiles="@(DllFiles)"
        DestinationFolder="$(DllTargetFolder)"
      />
    </Target>
</Project>
